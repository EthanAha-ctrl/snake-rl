# CartPole Perception Project

This project aims to train a perception model to determine the cart's position and the pole's angle from a single rendered frame of the `CartPole-v1` environment.

## Project Structure

- `generate_data.py`: This script runs the CartPole environment for a specified number of episodes, collecting rendered frames and their corresponding state information (cart position and pole angle) using an A2C agent for stable trajectories. It saves this data into a `data` directory.

- `train.py`: This script defines and trains a regression model using a custom `SimpleCNN` architecture. It loads the data generated by `generate_data.py`, trains the model to predict the cart position and pole angle, and saves the trained model as `position_detection.pth`. It also integrates TensorBoard for real-time training visualization.

- `evaluate.py`: This script loads the trained model `position_detection.pth` and runs the CartPole environment. In each step, it uses the model to predict the cart position and pole angle from the rendered frame. It then visualizes the prediction by drawing a line on the image and printing the predicted versus actual values.

## How to Run

### 1. Generate Data

First, you need to generate the training data. Run the following command:

```bash
python cartpole_perception/generate_data.py
```

This will train a simple A2C agent and then use it to generate a dataset, creating a `data` directory containing `images.npy` and `labels.npy`.

### 2. Train the Model

Once the data is generated, you can train the model.

```bash
python cartpole_perception/train.py
```

This script will train the model and save it as `position_detection.pth`.

#### Monitoring Training with TensorBoard

During training, you can monitor the loss in real-time using TensorBoard. Open your terminal and navigate to the project's root directory (`snake-rl/`). Then run:

```bash
tensorboard --logdir runs
```

Open your web browser and go to the address provided by TensorBoard (usually `http://localhost:6006/`).

### 3. Evaluate the Model

After the model is trained, you can evaluate its performance:

```bash
python cartpole_perception/evaluate.py
```

This will open a window showing the CartPole environment with a red line indicating the predicted cart position. The console will display the predicted and actual values for cart position and pole angle.